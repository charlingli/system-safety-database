<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <body>
        <ui:composition template="./../../templates/masterTemplate.xhtml">
            <ui:define name="content">
                <h:form id="hazardsForm">
                    <div class="pagePathNew"><h:outputText value="#{pagePath_MB.pageHtmlPath}" escape="false"/></div>
                    <p:messages autoUpdate="true" showDetail="true" showSummary="false"/>
                    <p:fieldset id="fieldset" legend="Search parameters" toggleable="true" toggleSpeed="1000" styleClass="hazardsFieldset" collapsed="true">
                        <h:panelGrid columns="2" columnClasses="searchFields,searchExplanation">
                            <p:accordionPanel id="srchfields" multiple="true" style="width: 440px" activeIndex="null">
                                <p:tab title="Hazard Fields">
                                    <p:panel>
                                        <p:panelGrid columns="2" styleClass="justPanelGridborders" columnClasses="searchGridLeft,searchGridRight">
                                            <p:outputLabel>Hazard Description:</p:outputLabel>
                                            <p:inputText id="HDInput" value="#{hazardView_MB.searchedHazardDescription}"></p:inputText>
                                            <p:outputLabel>Hazard Causes:</p:outputLabel>
                                            <p:inputText id="CAInput" value="#{hazardView_MB.searchedCauses}"></p:inputText>
                                            <p:outputLabel>Hazard Consequences:</p:outputLabel>
                                            <p:inputText id="CQInput" value="#{hazardView_MB.searchedConsequences}"></p:inputText>
                                            <p:outputLabel>Hazard Comments:</p:outputLabel>
                                            <p:inputText value="#{hazardView_MB.searchedHazardComments}"></p:inputText>
                                            <p:outputLabel>Hazard Location:</p:outputLabel>
                                            <p:selectCheckboxMenu id="HLInput" value="#{hazardView_MB.selectedLocations}" label="Hazard Locations" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listLocations}" var="location" itemLabel="#{location.locationName}" itemValue="#{location.locationId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Hazard Project:</p:outputLabel>
                                            <p:selectCheckboxMenu id="HPInput" value="#{hazardView_MB.selectedProjects}" label="Hazard Projects" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listProjects}" var="project" itemLabel="#{project.projectName}" itemValue="#{project.projectId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Grade Separation:</p:outputLabel>
                                            <p:selectCheckboxMenu id="GSInput" value="#{hazardView_MB.selectedGradeSeparations}" label="Grade Separations" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listGradeSeparations}" var="gradeSeparation" itemLabel="#{gradeSeparation.gradeSeparationName}" itemValue="#{gradeSeparation.gradeSeparationId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Construction Type:</p:outputLabel>
                                            <p:selectCheckboxMenu id="CNInput" value="#{hazardView_MB.selectedConstructionTypes}" label="Construction Types" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listConstructionTypes}" var="constructionType" itemLabel="#{constructionType.constructionTypeName}" itemValue="#{constructionType.constructionTypeId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Change Type:</p:outputLabel>
                                            <p:selectCheckboxMenu id="CHInput" value="#{hazardView_MB.selectedChangeTypes}" label="Change Types" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listChangeTypes}" var="changeType" itemLabel="#{changeType.changeTypeName}" itemValue="#{changeType.changeTypeId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Hazard Activity:</p:outputLabel>
                                            <p:selectCheckboxMenu id="HAInput" value="#{hazardView_MB.selectedHazardActivities}" label="Hazard Activities" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listHazardActivities}" var="hazardActivity" itemLabel="#{hazardActivity.activityName}" itemValue="#{hazardActivity.activityId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Hazard Context:</p:outputLabel>
                                            <p:selectCheckboxMenu id="HCInput" value="#{hazardView_MB.selectedHazardContexts}" label="Hazard Contexts" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listHazardContexts}" var="hazardContext" itemLabel="#{hazardContext.hazardContextName}" itemValue="#{hazardContext.hazardContextId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Hazard Type:</p:outputLabel>
                                            <p:selectCheckboxMenu id="HTInput" value="#{hazardView_MB.selectedHazardTypes}" label="Hazard Types" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listHazardTypes}" var="hazardType" itemLabel="#{hazardType.hazardTypeName}" itemValue="#{hazardType.hazardTypeId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Hazard Status:</p:outputLabel>
                                            <p:selectCheckboxMenu id="HSInput" value="#{hazardView_MB.selectedHazardStatuses}" label="Hazard Statuses" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listHazardStatuses}" var="hazardStatus" itemLabel="#{hazardStatus.hazardStatusName}" itemValue="#{hazardStatus.hazardStatusId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Hazard Owner:</p:outputLabel>
                                            <p:selectCheckboxMenu id="HOInput" value="#{hazardView_MB.selectedHazardOwners}" label="Hazard Owners" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listHazardOwners}" var="hazardOwner" itemLabel="#{hazardOwner.ownerName}" itemValue="#{hazardOwner.ownerId}"/>
                                            </p:selectCheckboxMenu>
                                        </p:panelGrid>
                                    </p:panel>
                                </p:tab>
                                <p:tab title="System Breakdown Structure Codes">
                                    <p:tree value="#{trees_MB.root}" var="doc"
                                            selectionMode="checkbox"
                                            selection="#{hazardView_MB.TNSelectedNodes}"
                                            style="width: 100%">
                                        <p:treeNode>
                                            <h:outputText value="#{doc}" />
                                        </p:treeNode>
                                    </p:tree>
                                </p:tab>
                                <p:tab title="Control Fields">
                                    <p:panel>
                                        <p:panelGrid columns="2" columnClasses="searchGridLeft,searchGridRight">
                                            <p:outputLabel>Control Description:</p:outputLabel>
                                            <p:inputText value="#{hazardView_MB.searchedControlDescription}"></p:inputText>
                                            <p:outputLabel>Control Justification:</p:outputLabel>
                                            <p:inputText value="#{hazardView_MB.searchedControlJustification}"></p:inputText>
                                            <p:outputLabel>Control Hierarchy:</p:outputLabel>
                                            <p:selectCheckboxMenu id="CHMenu" value="#{hazardView_MB.selectedControlHierachies}" label="Hierarchys" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listControlHierarchies}" var="controlHier" itemLabel="#{controlHier.controlHierarchyName}" itemValue="#{controlHier.controlHierarchyId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Control Owner:</p:outputLabel>
                                            <p:selectCheckboxMenu id="COMenu" value="#{hazardView_MB.selectedControlOwners}" label="Owners" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listHazardOwners}" var="controlOwner" itemLabel="#{controlOwner.ownerName}" itemValue="#{controlOwner.ownerId}"/>
                                            </p:selectCheckboxMenu>
                                            <p:outputLabel>Control Recommendation:</p:outputLabel>
                                            <p:selectCheckboxMenu id="CRMenu" value="#{hazardView_MB.selectedControlRecommendations}" label="Recommendations" filter="true" filterMatchMode="contains" style="width: 100%">
                                                <f:selectItems value="#{hazardView_MB.listControlRecommendations}" var="controlRecommendation" itemLabel="#{controlRecommendation.controlRecommendName}" itemValue="#{controlRecommendation.controlRecommendId}"/>
                                            </p:selectCheckboxMenu>
                                        </p:panelGrid>
                                    </p:panel>
                                </p:tab>
                            </p:accordionPanel>
                            <p:panel styleClass="queryDescr" visible="#{hazardView_MB.enableQueryDescr}">
                                <h:outputText value="#{hazardView_MB.htmlCode}" escape="false"/>
                            </p:panel>
                        </h:panelGrid>
                    </p:fieldset>
                    <div class="searchButtonsGrid">
                        <p:commandButton value="Search Hazards" action="#{hazardView_MB.constructSearchObject()}" update="hazardsForm" />
                        <p:commandButton value="Reset Fields" update="hazardsForm" process="@this" action="#{hazardView_MB.resetFields()}" >
                            <p:resetInput target="hazardsForm" />
                        </p:commandButton>
                    </div>
                    <p:dataTable id="hazardsTable" value="#{hazardView_MB.hazardSearchedlist}" var="hazard" emptyMessage="No hazard entries found with given criteria" 
                                 scrollable="true" scrollHeight="680" scrollRows="100" liveScroll="true" style="padding-left: 2px">
                        <f:facet name="header">
                            <p:outputPanel>
                                <p:commandButton id="columnToggle" value="Show/Hide Columns" icon="ui-icon-calculator" action="#{hazardView_MB.popUpWindow()}" onclick="this.form.target='_blank'" ajax="false">
                                    <f:param name="hazard.list" value="#{hazardView_MB.hazardSearchedlist}" />
                                </p:commandButton>
                            </p:outputPanel>
                        </f:facet>
                        <p:column style="width: 7%">
                            <f:facet name="header">
                                <h:outputText value="Hazard ID"/>
                            </f:facet>
                            <h:outputText value="#{hazard.hazardId}"/>
                        </p:column>
                        <p:column style="width: 12%">
                            <f:facet name="header">
                                <h:outputText value="Description"/>
                            </f:facet>
                            <h:outputText value="#{hazard.hazardDescription}"/>
                        </p:column>
                        <p:column style="width: 15%">
                            <f:facet name="header">
                                <h:outputText value="Comment"/>
                            </f:facet>
                            <h:outputText value="#{hazard.hazardComment}"/>
                        </p:column>
                        <p:column style="width: 6%">
                            <f:facet name="header">
                                <h:outputText value="Context"/>
                            </f:facet>
                            <h:outputText value="#{hazard.hazardContextId.hazardContextName}"/>
                        </p:column>
                        <p:column style="width: 6%">
                            <f:facet name="header">
                                <h:outputText value="Location"/>
                            </f:facet>
                            <h:outputText value="#{hazard.hazardLocation.locationName}"/>
                        </p:column>
                        <p:column style="width: 8%">
                            <f:facet name="header">
                                <h:outputText value="Activity"/>
                            </f:facet>
                            <h:outputText value="#{hazard.hazardActivity.activityName}"/>
                        </p:column>
                        <p:column style="width: 7%">
                            <f:facet name="header">
                                <h:outputText value="Type"/>
                            </f:facet>
                            <h:outputText value="#{hazard.hazardTypeId.hazardTypeName}"/>
                        </p:column>
                        <p:column style="width: 7%">
                            <f:facet name="header">
                                <h:outputText value="Status"/>
                            </f:facet>
                            <h:outputText value="#{hazard.hazardStatusId.hazardStatusName}"/>
                        </p:column>
                        <p:column style="width: 7%">
                            <f:facet name="header">
                                <h:outputText value="Owner"/>
                            </f:facet>
                            <h:outputText value="#{hazard.ownerId.ownerName}"/>
                        </p:column>
                    </p:dataTable>
                </h:form>
            </ui:define>
        </ui:composition>
    </body>
</html>
