<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <link rel="stylesheet" type="text/css" media="all" href="../../resources/css/default.css"/>
        <link rel="stylesheet" type="text/css" media="all" href="../../resources/css/hazMateStyle.css"/>
        <link rel="shortcut icon" href="#{resource['img/hazMateLogo.png']}" type="image/x-icon"/>
        <title>System Safety Database</title>
        <meta name="viewport" content="width=device-width, maximum-scale=1.0, minimum-scale=1.0, initial-scale=1.0"/>
        <f:event type="preRenderView" listener="#{login_MB.validateSession()}"/>
        
    </h:head>
    <h:body class="body">
        <header id="top">
            <ui:insert name="top">
                <h:form id="headerForm">
                    <p:idleMonitor timeout="480000">
                        <p:ajax event="idle" listener="#{login_MB.onIdle8}" update="growl"/>
                    </p:idleMonitor>
                    <p:menubar model="#{menuDynamic_MB.menuContent}">
                        <f:facet name="options">
                            <c:choose>
                                <c:when test="#{login_MB.isAdminUser()}">
                                    <p:menuButton icon="fa fa-tasks" styleClass="#{userWF_MB.getWFProposedListSize() > 0 || userWF_MB.getWFAddressListSize() > 0 ? 'workflow-badge' : ''}" id="workflowAdmin">
                                        <p:menuitem value="Proposed Changes (#{userWF_MB.getWFProposedListSize()})" action="/data/workflow/adminWF" icon="fa fa-check"/>
                                        <p:menuitem value="Address Suggestions (#{userWF_MB.getWFAddressListSize()})" action="/data/workflow/userWF" icon="fa fa-pencil"/>
                                    </p:menuButton>
                                    <p:tooltip id="toolTipWorkflowAdmin" for="workflowAdmin" trackMouse="true">
                                        <h:outputText value="#{userWF_MB.getWFProposedListSize()} workflows requiring approval"/>
                                        <br/>
                                        <h:outputText value="#{userWF_MB.getWFAddressListSize()} workflows with comments"/>
                                    </p:tooltip>
                                </c:when>
                                <c:otherwise>
                                    <p:commandButton icon="fa fa-dashboard" styleClass="#{userWF_MB.getWFAddressListSize() > 0 ? 'workflow-badge' : ''}" action="/data/workflow/userWF" id="workflowUser"/>
                                    <p:tooltip id="toolTipWorkflowUser" for="workflowUser" trackMouse="true">
                                        <h:outputText value="#{userWF_MB.getWFAddressListSize()} workflows with comments"/>
                                    </p:tooltip>
                                </c:otherwise>
                            </c:choose>
                            <p:spacer width="20" height="20"/>
                            <p:commandButton icon="fa fa-home" action="/admin/masterMenu" id="home"/>
                            <p:tooltip id="toolTipHome" for="home" value="Home" trackMouse="true"/>
                            <p:spacer width="20" height="20"/>
                            <p:commandButton icon="fa fa-user" action="/admin/users/activeUserProfile" id="profile"/> 
                            <p:tooltip id="toolTipProfile" for="profile" value="Profile" trackMouse="true"/>
                            <p:spacer width="20" height="20"/>
                            <p:commandButton icon="fa fa-power-off" id="power" actionListener="#{login_MB.closeSession()}" action="/login?faces-redirect=true"/>
                            <p:tooltip id="toolTipPower" for="power" value="Logout" trackMouse="true"/>
                            <p:spacer width="20" height="20"/>
                        </f:facet>
                    </p:menubar>
                    <div class="messageDiv">
                        <p:messages id="messages" showDetail="true" showSummary="false" severity="error, warn" closable="true" styleClass="messageDiv">
                            <p:autoUpdate/>
                        </p:messages>
                        <p:growl id="growl" showDetail="true" showSummary="false" severity="info" class="timeout">
                            <p:autoUpdate/>
                        </p:growl>
                    </div>
                </h:form>
            </ui:insert>
        </header>
        <main class="content">
            <div id="content">
                <ui:insert name="content"></ui:insert>
            </div>
        </main>
        <footer class="license">
            <ui:insert name="footer">
                <p:separator/>
                <h:form>
                    <h:outputText value="System Safety Database is proprietary software owned and operated by Level Crossing Removal Authority. Status: "/>
                    <h:outputText style="font-weight: bold; color: rgb(179, 139, 52)" value="in development"/>
                    <h:outputText value=". Track our changes on our "/>
                    <a class="commandLink" href="https://trello.com/b/MkVdC6k7/system-safety-database">Trello board</a>
                    <h:outputText value=" and find release notes on our "/>
                    <a class="commandLink" href="https://dtpli.sharepoint.com/sites/lxra-team/ssd">SharePoint subsite</a>
                    <h:outputText value=". Please send all feedback to "/>
                    <a class="commandLink" href="mailto:#{activeUser_MB.systemEmail}">the developers</a>
                    <h:outputText value="."/>
                </h:form>
            </ui:insert>
        </footer>
    </h:body>
</html>
